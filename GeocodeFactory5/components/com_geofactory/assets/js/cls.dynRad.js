function DistanceWidget(a,b){this.gfMap=a,this.set("map",a.map),this.set("position",b);var c=new google.maps.MarkerImage(a.dynRadIcoCenter,new google.maps.Size(20,20),new google.maps.Point(0,0),new google.maps.Point(10,10)),d=new google.maps.Marker({draggable:!0,icon:c,title:a.dynRadTxtCenter});d.bindTo("map",this),d.bindTo("position",this);var e=new RadiusWidget(a);e.bindTo("map",this),e.bindTo("center",this,"position"),this.bindTo("distance",e),this.bindTo("bounds",e),this.getRadius=function(){return e.get("distance")},this.setMap=function(){this.set("map",null)},this.getBounds=function(){return e.get("bounds")}}function RadiusWidget(a){this.gfMap=a;var b=new google.maps.Circle({strokeWeight:2,strokeColor:a.colorRadius,fillColor:a.colorRadius,fillOpacity:.15});this.set("distance",mj_radiusdistance),this.bindTo("bounds",b),b.bindTo("center",this),b.bindTo("map",this),b.bindTo("radius",this),this.addSizer_()}function displayInfo(a){updatePosition(a.gfMap.nameAddressInput),distance=a.get("distance"),distance>a.gfMap.dynRadDistMax&&(distance=a.gfMap.dynRadDistMax);var b=document.getElementById(a.gfMap.nameRadiusSelect),c=document.createElement("INPUT");c.id=a.gfMap.nameRadiusSelect,c.type="text",c.style.width="50px",c.className="gfMapControls",c.value=Math.round(100*distance)/100,b=b.parentNode.replaceChild(c,b)}function updatePosition(a){distWidgetTimer&&window.clearTimeout(distWidgetTimer),distWidgetTimer=window.setTimeout(function(){reverseGeocodePosition(a),mj_radiuscenter=distanceWidget.get("position"),distanceWidget.gfMap.reloadAndRefreshMap()},500)}function reverseGeocodePosition(a){var b=distanceWidget.get("position"),c=new google.maps.Geocoder,d=document.getElementById(a),e=Math.round(100*b.lat())/100+","+Math.round(100*b.lng())/100;d.blur(),setTimeout(function(){d.value=""},10),c.geocode({latLng:b},function(a,b){return b==google.maps.GeocoderStatus.OK&&a[1]?(d.placeholder=a[1].formatted_address,d.title=e,void 0):void 0}),d.placeholder=e,d.title=e}DistanceWidget.prototype=new google.maps.MVCObject,RadiusWidget.prototype=new google.maps.MVCObject,RadiusWidget.prototype.distance_changed=function(){mj_radiusdistance=this.get("distance"),mj_radiusdistance>this.gfMap.dynRadDistMax&&(mj_radiusdistance=this.gfMap.dynRadDistMax),this.set("radius",mj_radiusdistance*this.gfMap.radFact)},RadiusWidget.prototype.addSizer_=function(){var a=new google.maps.MarkerImage(this.gfMap.dynRadIcoDrag,new google.maps.Size(26,10),new google.maps.Point(0,0),new google.maps.Point(13,5)),b=new google.maps.Marker({draggable:!0,icon:a,title:this.gfMap.dynRadTxtDrag});b.bindTo("map",this),b.bindTo("position",this,"sizer_position");var c=this;google.maps.event.addListener(b,"drag",function(){c.setDistance()})},RadiusWidget.prototype.center_changed=function(){var a=this.get("bounds");if(a){var b=a.getNorthEast().lng(),c=new google.maps.LatLng(this.get("center").lat(),b);this.set("sizer_position",c)}},RadiusWidget.prototype.setDistance=function(){var a=this.get("sizer_position"),b=this.get("center"),c=getDistanceBetweenPoints(b,a);this.set("distance",c)};